"use strict";var app=angular.module("app",["ui.router","app.services","app.main","app.auth","app.dashboard","app.optionform","app.createevent","app.showevent","app.restaurantresults"]);app.config(function(t,e,a,r){e.otherwise("/"),t.state("main",{url:"/","abstract":!0,templateUrl:"app/views/welcome.html",controller:"MainCtrl"}).state("main.buttons",{url:"",templateUrl:"app/views/welcomebuttons.html"}).state("main.signup",{templateUrl:"app/views/signup.html",controller:"AuthCtrl"}).state("main.signin",{templateUrl:"app/views/signin.html",controller:"AuthCtrl"}).state("dashboard",{url:"/dashboard",templateUrl:"app/views/dashboard.html",controller:"DashboardCtrl",authenticate:!0}).state("dashboard.createevent",{url:"/createevent",templateUrl:"app/views/eventform.html",controller:"CreateEventCtrl",authenticate:!0}).state("dashboard.showevent",{url:"/events",templateUrl:"app/views/showevent.html",controller:"ShowEventCtrl",authenticate:!0}).state("dashboard.optionform",{url:"/optionform",templateUrl:"app/views/optionform.html",controller:"OptionformCtrl",authenticate:!0}).state("dashboard.restaurantResults",{url:"/recommendation",templateUrl:"app/views/restaurantResults.html",controller:"RestaurantResultsCtrl",authenticate:!0}).state("dashboard.loading",{url:"/loading",templateUrl:"app/views/loading.html",authenticate:!0}).state("dashboard.profile",{url:"/profile",templateUrl:"app/views/profile.html",authenticate:!0}).state("dashboard.editprofile",{url:"/editprofile",templateUrl:"app/views/editprofile.html",controller:"OptionformCtrl",authenticate:!0}),a.html5Mode(!0),r.interceptors.push("AttachTokens")}).factory("AttachTokens",function(t){var e={request:function(e){var a=t.localStorage.getItem("com.app");return a&&(e.headers["x-access-token"]=a),e.headers["Allow-Control-Allow-Origin"]="*",e}};return e}).run(function(t,e,a){t.$on("$stateChangeStart",function(t,r,o,n,l){r.authenticate&&!a.isAuth()&&(e.go("main.buttons"),t.preventDefault())})}),angular.module("app.auth",["app.services"]).controller("AuthCtrl",["$scope","$state","Auth","$window",function(t,e,a,r){t.signin=function(){a.signin(t.user).then(function(t){r.localStorage.setItem("com.app",t),e.go("dashboard")})["catch"](function(t){console.error(t)})},t.signup=function(){a.signup(t.user).then(function(t){r.localStorage.setItem("com.app",t),e.go("dashboard")})["catch"](function(t){console.error(t)})}}]),angular.module("app.createevent",[]).controller("CreateEventCtrl",["$scope",function(t){}]),angular.module("app.dashboard",["app.services"]).controller("DashboardCtrl",["$scope","$state","Auth",function(t,e,a){t.signout=function(){a.signout()}}]),angular.module("app.main",["app.services"]).controller("MainCtrl",["$scope","$state","Auth",function(t,e,a){}]),angular.module("app.optionform",["app.services"]).controller("OptionformCtrl",["$scope","$location","$state","userFactory","restaurantFactory",function(t,e,a,r,o){t.getUserReq=function(){a.go("dashboard.loading"),r.userReq(t.user).then(function(t){o.restaurants=t.data.slice(0,11),console.log(o.restaurants),a.go("dashboard.restaurantResults")})}}]),angular.module("app.restaurantresults",[]).controller("RestaurantResultsCtrl",["$scope","restaurantFactory",function(t,e){t.data={restaurants:e.restaurants},t.logger=function(){console.log("hit")}}]),angular.module("app.showevent",[]).controller("ShowEventCtrl",["$scope",function(t){}]),angular.module("app.services",[]).factory("userFactory",["$http","$state",function(t,e){var a=function(e){return t({method:"POST",url:"/api/search",data:e}).then(function(t){return console.log(t.data[0]),t})};return{userReq:a}}]).factory("restaurantFactory",[function(){var t;return{restaurants:t}}]).factory("Auth",["$http","$state","$window",function(t,e,a){var r=function(e){return t({method:"POST",url:"/api/users/signin",data:e}).then(function(t){return t.data.token})["catch"](function(t){console.error(t)})},o=function(e){return console.log(e),t({method:"POST",url:"/api/users/signup",data:e}).then(function(t){return t.data.token})["catch"](function(t){console.error(t)})},n=function(){return!!a.localStorage.getItem("com.app")},l=function(){a.localStorage.removeItem("com.app")};return{signin:r,signup:o,isAuth:n,signout:l}}]);